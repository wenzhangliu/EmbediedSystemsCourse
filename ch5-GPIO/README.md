# 第5章 GPIO接口

```
作者：柳文章
日期：2025.3.16
```

目录索引:

- GPIO结构及特点
- GPIO寄存器和库函数
- 案例：按键控制小灯
    - 新建工程
    - 编写主程序
    - GPIO输入和输出配置
    - 按键去抖
    - 按键处理程序

## GPIO结构及特点

GPIO输出模式：

| 输出模式     | 输出信号来源 | 推挽或开漏 |
|----------|--------|-------|
| 通用开漏输出   | 输出高低电平 | 开漏    |
| 通用推挽输出   |        | 推挽    |
| 复用开漏输出   | 片上外设   | 开漏    |
| 复用推挽输出   |        | 推挽    |

GPIO输入模式：

| 输入模式 | 输入信号去向       | 上拉或下拉 |
|---------|--------------|-------|
| 模拟输入 | 片上模拟外设ADC    | 无     |
| 浮空输入 | 输入数据寄存器或片上外设 | 无     |
| 下拉输入 | 输入数据寄存器或片上外设 | 下拉    |
| 上拉输入 | 输入数据寄存器或片上外设 | 上拉    |

### GPIO功能模式

- GPIO复用功能：除I/O外，还可用于串口、定时器、I2C等。
- GPIO数字输入模式：将不规则脉冲信号整合为矩阵脉冲信号。
- 模拟输入模式：接收模拟量。
- 推挽输出模式：通用推挽输出、复用推挽输出。
- 开漏输出模式：GPIO输出1时引脚悬空，输出0时，引脚接地。
- GPIO输出速度设定：2MHz, 10MHz, 50MHz。
- 钳位功能：防止外部输入的电压过高或过低。

### GPIO特点

- I/O口电平兼容：除了模拟量最大承受电压为3.6V，其余多数I/O口兼容5V输入，且所有I/O口兼容CMOS和TTL。
- I/O口驱动能力：最大可吸收25mA电流。
- 内部上拉/下拉设置。
- I/O口可配置为外部中断口。
- 具有独立的唤醒I/O口。
- 具备锁存功能。
- 具有侵入检测引脚。

## GPIO寄存器和库函数

### GPIO寄存器

GPIO寄存器功能表：

| 寄存器                    | 功能                                                  |
|------------------------|-----------------------------------------------------|
| 端口配置低寄存器（GPIO_CRL）     | 配置端口低8位IO口Px0-Px7                                   |
| 端口配置高寄存器（GPIO_CRH）     | 配置端口高8位IO口Px8-Px15                                  |
| 端口输入数据寄存器（GPIO_IDR）    | 获取16个IO口上的输入数据                                      |
| 端口输出数据寄存器（GPIO_ODR）    | 控制16个IO口输出数据                                        |
| 端口位设置/清除寄存器（GPIO_BSRR） | 高16位，用于清除Px0-Px15对应的位为0；<br>低16位，用于设置Px0-Px15对应的位为1 |
| 端口位清除寄存器（GPIO_BRR）     | 低16位，用于清除Px0-Px15对应的位为0                             |
| 端口配置锁定寄存器（GPIO_LCKR）   | 第16位，配置端口锁键；<br>15-0位，配置Px0-Px15对应的锁键               |

### GPIO库函数

GPIO库函数列表：

| 函数名         | 描述 |
|-------------|-----|
| GPIO_DeInit |    |
|GPIO_|    |
|GPIO_|    |
|GPIO_|    |
|GPIO_|    |
|GPIO_|    |
|GPIO_|    |
|GPIO_|    |
|GPIO_|    |
|GPIO_|    |
|GPIO_|    |
|GPIO_|    |
|GPIO_|    |
|GPIO_|    |
|GPIO_|    |
|GPIO_|    |
|GPIO_|    |

## 案例：按键控制小灯

### 新建工程

### 编写main.c

### GPIO输入和输出配置

### 按键去抖

### 按键处理程序